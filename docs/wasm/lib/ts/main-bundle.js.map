{"version":3,"file":"main-bundle.js","sources":["common/host-origin.ts","common/file-xfer.ts","route.ts","editor.ts","filelist.ts","main.ts"],"sourcesContent":["\nexport const ORIGIN = (() => {\n    var b = window.location.href.split(\"/\");\n    return [b[0], b[1], b[2]].join(\"/\");\n})();\n","declare const FS: any;\n\nimport { ORIGIN } from \"./host-origin\";\n\nlet messageCounter = 1000;\n\nconst TYPE_FILE = 'F';\nconst TYPE_DIR = 'D';\n\nexport interface FileListItem {\n    displayName: string;\n    fullPath: string;\n    type: string;\n}\n\nconst sendMessage = <T extends BaseSendMessageRequest, U>(destwindow: Window, message: T) => {\n    const currentMessageCounter = messageCounter;\n    messageCounter += 1;\n\n    return new Promise<U>((resolve, reject) => {\n        const replyListener = function replyListener(e: MessageEvent) {\n            if (e.origin === ORIGIN) {\n                const data = JSON.parse(e.data);\n\n                if (data.messageID === currentMessageCounter) {\n                    window.removeEventListener('message', replyListener, false);\n                    resolve(data);\n                }\n            }\n        }\n\n        window.addEventListener('message', replyListener, false);\n        message.messageID = currentMessageCounter;\n        destwindow.postMessage(JSON.stringify(message), ORIGIN);\n    });\n};\n\n\nconst waitForPong = () => {\n    return new Promise((resolve, reject) => {\n        const replyListener = function replyListener(e: MessageEvent) {\n            if (e.origin === ORIGIN) {\n                const data = JSON.parse(e.data);\n\n                if (data.action === \"PONG\") {\n                    window.removeEventListener('message', replyListener, false);\n                    resolve(data);\n                }\n            }\n        }\n\n        window.addEventListener('message', replyListener, false);\n    });\n};\n\nconst sendPong = (destwindow: Window) => {\n    const message = {\n        action: \"PONG\",\n    }\n    destwindow.postMessage(JSON.stringify(message), ORIGIN);\n};\n\nconst getFileListEvent = (data: GetFileListRequest) => {\n    const names = FS.readdir(data.dir).filter((n: string) => n !== \".\");\n\n    const list: DirectoryList[] = names.map((n: string) => {\n        const s = FS.lstat(`${data.dir}/${n}`);\n\n        const isDir = FS.isDir(s.mode);\n        const isFile = FS.isFile(s.mode);\n\n        const type = (isDir ? TYPE_DIR : \"\") + (isFile ? TYPE_FILE : \"\");\n\n        const blocks = type === TYPE_DIR ? \"[]\" : \"\";\n        const displayName = blocks.charAt(0) + n.toUpperCase() + blocks.charAt(1);\n        const r: DirectoryList = {\n            displayName,\n            name: n,\n            type,\n            fullPath: `${data.dir}/${n}`,\n\n        };\n\n        return r;\n    });\n\n    var dirs = list.filter((p) => p.type === TYPE_DIR);\n    var files = list.filter((p) => p.type === TYPE_FILE);\n\n    interface FileSortValue {\n        name: string;\n    }\n\n    const sortF = (a: FileSortValue, b: FileSortValue) => (a.name.toUpperCase() > b.name.toUpperCase()) ? 1 : -1;\n\n    dirs.sort(sortF);\n    files.sort(sortF);\n\n    const response: GetFileListResponse = {\n        isSuccess: true,\n        files: [...dirs, ...files],\n        messageID: data.messageID,\n    };\n\n    parent.postMessage(JSON.stringify(response), ORIGIN);\n};\n\nconst unlinkFileEvent = (request: UnlinkFileRequest) => {\n    FS.writeFile(request.filename, \"\");\n    FS.unlink(request.filename);\n\n    const response: UnlinkFileResponse = {\n        messageID: request.messageID,\n    };\n\n    parent.postMessage(JSON.stringify(response), ORIGIN);\n};\n\nconst writeTextFile = (request: WriteTextFileRequest) => {\n    FS.writeFile(request.filename, request.contents);\n    const response: WriteTextFileResponse = {\n        messageID: request.messageID,\n    };\n    parent.postMessage(JSON.stringify(response), ORIGIN);\n};\n\nconst writeBinaryFile = (request: WriteBinaryFileRequest) => {\n    FS.writeFile(request.filename, request.contents);\n    const response: WriteBinaryFileResponse = {\n        messageID: request.messageID,\n    };\n    parent.postMessage(JSON.stringify(response), ORIGIN);\n};\n\nconst readTextFileEvent = (request: ReadTextFileRequest) => {\n    const response: ReadTextFileResponse = {\n        isSuccess: true,\n        contents: FS.readFile(request.filename, { encoding: \"utf8\" }),\n        messageID: request.messageID,\n    }\n    parent.postMessage(JSON.stringify(response), ORIGIN);\n};\n\nconst readBinaryFileEvent = (request: ReadBinaryFileRequest) => {\n    const response: ReadBinaryFileResponse = {\n        isSuccess: true,\n        contents: FS.readFile(request.filename),\n        messageID: request.messageID,\n    }\n    parent.postMessage(JSON.stringify(response), ORIGIN);\n};\n\nconst assertNever = (x: never): never => {\n    // Don't panic.\n    // throw new Error(`Unexpected object: ${x}`);\n    return null as never;\n}\n\nconst ioEventListener = function (e: MessageEvent) {\n    if (e.origin === ORIGIN) {\n        const request = JSON.parse(e.data) as IOEvent;\n\n        switch (request.action) {\n            case \"writeTextFile\":\n                writeTextFile(request);\n                break;\n            case \"writeBinaryFile\":\n                writeBinaryFile(request);\n                break;\n            case \"readTextFile\":\n                readTextFileEvent(request);\n                break;\n            case \"readBinaryFile\":\n                readBinaryFileEvent(request);\n                break;\n            case \"unlinkFile\":\n                unlinkFileEvent(request);\n                break;\n            case \"getFileList\":\n                getFileListEvent(request);\n                break;\n            default:\n                assertNever(request);\n        }\n    }\n}\n\nwindow.addEventListener('message', ioEventListener, false);\n\nexport default {\n    sendMessage,\n    waitForPong,\n    sendPong,\n    TYPE_DIR,\n    TYPE_FILE,\n}","interface StateData {\n    [key: string]: any;\n}\n\nconst makeOnloadState = (action: string, value: string) => {\n    const state: StateData = [];\n    state[action] = value;\n\n    history.pushState(state, \"\", window.location.href);\n    history.pushState(state, \"\", window.location.href);\n}\n\nconst onload = function () {\n    showSection(\"main\");\n    return;\n\n    hideAllSections();\n\n    // Check if this is a reload, in which case you are already on a slide.\n    const urlParams = new URLSearchParams(window.location.search);\n\n    if (urlParams.has(\"section\")) {\n        const section = urlParams.get(\"section\");\n        if (section !== null) {\n            makeOnloadState(\"section\", section || \"\");\n            showSection(section || \"\");\n        } else {\n            const defaultSection = \"main\";\n            makeOnloadState(\"section\", defaultSection);\n            showSection(defaultSection);\n        }\n    }\n}\n\n// Fires when the user goes back or forward in the history.\nwindow.onpopstate = function (e: PopStateEvent) {\n    const section = e.state && e.state.section;\n    const routesToSkip = [\"filelist\"];\n\n    if (section) {\n        if (routesToSkip.indexOf(section) >= 0) {\n            this.history.back();\n            return;\n        }\n        showSection(section);\n    }\n}\n\n// Wire up the section handling too\nconst hideAllSections = () => {\n    const sections = document.querySelectorAll(\"section\");\n    Array.from(sections).forEach(section => {\n        section.style.display = \"none\";\n    })\n};\n\nconst showSection = ((sectionId: string) => {\n    hideAllSections();\n    const selector = `section[data-section-id='${sectionId}']`;\n    const el = document.querySelector(selector)! as HTMLElement;\n    el.style.display = \"\";\n});\n\nconst gotoSection = (section:string) => {\n    showSection(section);\n    return;\n\n    if (section) {\n        const state = {\n            \"section\": section,\n        };\n\n        history.pushState(state, \"\", \"/?section=\" + section);\n        showSection(section);\n    }\n\n};\n\ndocument.body.addEventListener(\"click\", (event) => {\n    const t = event.target as HTMLElement;\n    if (t?.dataset?.goto) {\n        // gotoSection(t.dataset.goto);\n        showSection(t.dataset.goto);\n    }\n});\n\nexport default {\n    onload,\n    hideAllSections,\n    gotoSection,\n};","// const input = document.querySelector(\".editor\");\n// const compileButton = document.querySelector(\".js-compile-button\");\n// const runButton = document.querySelector(\".js-run-button\");\n// const stepButton = document.querySelector(\".js-step-button\");\nvar cm: CodeMirror.Editor;\n\ndeclare const CodeMirror: any;\n\nlet lastLineMarker = -1;\nconst ERROR_STATE_CLASS = \"cm-editor-line-error\";\n\nconst init = (onchange: () => void) => {\n    cm = CodeMirror.fromTextArea(document.querySelector(\".editor\"), {\n        lineNumbers: true,\n        theme: \"dasm\",\n        lineWrapping: true,\n        gutters: [\"CodeMirror-linenumbers\", \"breakpoints\"],\n        fixedGutter: true,\n        styleActiveLine: true,\n    });\n\n    cm.on('change', function () {\n        if (typeof onchange === \"function\") {\n            onchange();\n        }\n    });\n\n    cm.on(\"gutterClick\", function (cm, n) {\n        var info = cm.lineInfo(n);\n        let mode = (!info.gutterMarkers || !info.gutterMarkers.breakpoints);\n        cm.setGutterMarker(n, \"breakpoints\", !mode ? null : makeMarker());\n    });\n\n    function makeMarker() {\n        var marker = document.createElement(\"div\");\n        marker.style.color = \"#822\";\n        marker.innerHTML = \"●\";\n        return marker;\n    }\n};\n\nconst setLineMarker = (line: number) => {\n    clearLineMarker(lastLineMarker);\n    lastLineMarker = line;\n    const marker = document.createElement(\"span\");\n    marker.innerHTML = \"▶\";\n    marker.style.color = \"green\";\n    marker.style.background = \"black\";\n    cm.setGutterMarker(line - 1, \"active-lines\", marker);\n    cm.scrollIntoView({ line: line - 1, ch: 0 }, 10);\n};\n\nconst clearLineMarker = (line: number) => {\n    cm.setGutterMarker(line - 1, \"active-lines\", null);\n};\n\nconst setValue = (value: string) => {\n    cm.setValue(value);\n}\n\nconst getValue = () => {\n    return cm.getValue();\n}\n\nconst clearAllErrors = () => {\n    cm.eachLine((f) => {\n        cm.removeLineClass(f, \"background\", ERROR_STATE_CLASS);\n    });\n}\n\nconst setErrors = (errors: number[]) => {\n    clearAllErrors();\n    errors.forEach(l => {\n        cm.addLineClass(l - 1, \"background\", ERROR_STATE_CLASS);\n    });\n}\n\nconst jumpToLine = (i: number) => {\n    var t = cm.charCoords({ line: i, ch: 0 }, \"local\").top;\n    var middleHeight = cm.getScrollerElement().offsetHeight / 2;\n    cm.scrollTo(null, t - middleHeight - 5);\n    cm.setCursor(i - 1, 0);\n    cm.focus();\n}\n\nexport const editor = {\n    init,\n    setValue,\n    getValue,\n    setLineMarker,\n    clearAllErrors,\n    setErrors,\n    jumpToLine,\n}\n","import fileXfer from \"./common/file-xfer\";\n\ninterface PickFileResult {\n    filename: string;\n    contents: string;\n}\n\nexport const fileList = (() => {\n    const pickFile = async (\n        cw: Window,\n        dir: string,\n        callback: (s: PickFileResult) => void) => {\n        const container = document.querySelector(\".filelist\") as HTMLElement;\n        container.innerHTML = \"\";\n\n        const reply = await fileXfer.sendMessage<GetFileListRequest, GetFileListResponse>\n            (cw, {\n                action: 'getFileList',\n                dir: dir,\n                messageID: 0,\n            });\n\n        (reply.files || []).forEach((l) => {\n            const li = document.createElement(\"li\");\n            const a = document.createElement(\"a\");\n\n            const t = document.createTextNode(l.displayName);\n\n            a.href = `#${l.fullPath}`;\n            a.appendChild(t);\n            li.appendChild(a);\n\n            li.classList.add(\"filelist-item\");\n            container.appendChild(li);\n\n            a.addEventListener(\"click\", async (event) => {\n                event.preventDefault();\n                const target = event?.target as HTMLLinkElement;\n\n                const thisname = target?.href?.split(\"#\")[1] || \"--\";\n\n                if (reply.files) {\n                    const d = reply.files.filter((a) => a.fullPath === thisname)[0];\n\n                    if (d.type === fileXfer.TYPE_FILE) {\n\n                        const selectedFileResult = await fileXfer.sendMessage<ReadTextFileRequest, ReadTextFileResponse>(cw, {\n                            action: 'readTextFile',\n                            messageID: 0,\n                            filename: thisname,\n                        });\n\n                        callback({\n                            filename: thisname,\n                            contents: selectedFileResult?.contents || \"\",\n                        });\n                    } else {\n                        pickFile(cw, thisname, callback);\n                    }\n                }\n            });\n        });\n    };\n\n    return {\n        pickFile,\n    }\n})();\n","import { ORIGIN } from \"./common/host-origin\";\nimport fileXfer from \"./common/file-xfer\";\n\nimport route from \"./route.js\";\nimport { editor } from \"./editor.js\";\nimport { fileList } from \"./filelist.js\";\n\nconst goButton = document.querySelector(\".js-go-button\") as HTMLButtonElement;\nconst assembleButton = document.querySelector(\".js-compile-button\") as HTMLButtonElement;\nconst editFileButton = document.querySelector(\".js-edit-file-button\") as HTMLButtonElement;\nconst loadFileButton = document.querySelector(\".js-load-file-button\") as HTMLButtonElement;\nconst assembleOutput = document.querySelector(\"#assemble-output\") as HTMLDivElement;\nconst menuButton = document.querySelector(\".js-show-menu\") as HTMLButtonElement;\n\nlet systemWindow: Window;\n\nconst DASM_IFRAME_ID = \"dasm-iframe\";\n\nconst editorFlags = {\n\tcanAssemble: true,\n\tcanRun: false,\n};\n\nlet rand = (minInclusive: number, maxInclusive: number) =>\n\tminInclusive + (maxInclusive - minInclusive + 1)\n\t* crypto.getRandomValues(new Uint32Array(1))[0] / 2 ** 32 | 0\n\n\nconst toHex = (num: number, places: number) => {\n\tif (num === undefined) {\n\t\treturn '$' + \"-------------\".slice(places);\n\t}\n\n\tlet s = num.toString(16);\n\twhile (s.length < places) {\n\t\ts = '0' + s;\n\t}\n\treturn '$' + s.toUpperCase();\n}\n\nconst destroydasmIframe = async () => {\n\tconst oldiframe = document.getElementById(DASM_IFRAME_ID);\n\tif (oldiframe) {\n\t\toldiframe.parentNode!.removeChild(oldiframe);\n\t}\n}\n\nconst loadDasmIFrame = async () => {\n\tawait destroydasmIframe();\n\n\tconst dasmIframe = document.createElement(\"iframe\");\n\tdasmIframe.id = DASM_IFRAME_ID;\n\tdasmIframe.src = \"dasm.html\";\n\tdasmIframe.style.display = \"none\";\n\n\tdocument.body.appendChild(dasmIframe);\n\n\tawait fileXfer.waitForPong();\n\n\treturn dasmIframe.contentWindow!;\n};\n\nconst loadSystemIFrame = async (url: string) => {\n\tconst systemdiv = document.querySelector(\".system\") as HTMLDivElement;\n\tif (systemdiv.firstChild) {\n\t\tsystemdiv.removeChild(systemdiv.firstChild);\n\t}\n\n\tconst systemIframe = document.createElement(\"iframe\");\n\tsystemIframe.id = \"system-iframe\";\n\tsystemIframe.src = url;\n\n\tsystemdiv.appendChild(systemIframe);\n\n\t// await fileXfer.waitForPong();\n\n\treturn systemIframe.contentWindow!;\n};\n\n\nconst assemble = async (\n\tassemblerWindow: any,\n\tfilename: string,\n\tsrc: string) => {\n\troute.gotoSection(\"wait\");\n\n\tconst sendmessagereply = await fileXfer.sendMessage<WriteTextFileRequest, WriteTextFileResponse>(assemblerWindow, {\n\t\tmessageID: 0,\n\t\taction: 'writeTextFile',\n\t\tfilename: `${filename}.asm`,\n\t\tcontents: src,\n\t});\n\n\tawait fileXfer.sendMessage<UnlinkFileRequest, UnlinkFileResponse>(assemblerWindow, {\n\t\tmessageID: 0,\n\t\taction: 'unlinkFile',\n\t\tfilename: `${filename}.bin`,\n\t});\n\n\tconst assembleResult = await fileXfer.sendMessage<RunAssemblerRequest, RunAssemblerResponse>(assemblerWindow, {\n\t\tmessageID: 0,\n\t\taction: 'runAssembler',\n\t\tfilename: `${filename}`,\n\t});\n\n\tconst errorLines = assembleResult.errors.map(e => e.line);\n\n\tif (errorLines.length === 0) {\n\t\tconst msg: SendRomMessage = {\n\t\t\taction: \"send-rom\",\n\t\t\tjson: JSON.stringify(assembleResult.binary),\n\t\t};\n\n\t\tconsole.log(`Posting ${msg.action}`);\n        systemWindow.postMessage(JSON.stringify(msg), ORIGIN);\n\t} else {\n\t\teditor.setErrors(errorLines);\n\n\t\tassembleOutput!.innerHTML = assembleResult.errors.map(l => {\n\t\t\treturn `<a href=\"#\"\n                 data-error-message=\"${l.error}\"\n                 data-line=\"${l.line}\"\n                 data-file=\"${l.file}\">\n                 Error: Line ${l.line}: ${l.error}\n               </a>`;\n\t\t}).join(\"<br>\");\n\n\t\teditorFlags.canRun = !assembleResult.errors.length;\n\t}\n\n\troute.gotoSection(\"editor\");\n\n\treturn assembleResult;\n};\n\nconst wireButtons = () => {\n\tlet lineMappings;\n\n\tconst runAssemble = async (filename: string, src: string) => {\n\t\tconst assemblerWindow = await loadDasmIFrame();\n\t\tconst assembleResult = await assemble(assemblerWindow, filename, src);\n\t\tdestroydasmIframe();\n\n\t\t// console.log(assembleResult.listing);\n\t\tlineMappings = buildLineMappings(assembleResult?.listing || \"--\");\n\n\t\tupdateButtons();\n\t};\n\n\tgoButton!.addEventListener(\"click\", async () => {\n\t\tawait runAssemble(\"/file\", editor.getValue());\n\t});\n\n\tassembleButton!.addEventListener(\"click\", () => {\n\t\trunAssemble(\"/file\", editor.getValue());\n\t});\n\n\teditFileButton!.addEventListener(\"click\", () => {\n\t\troute.gotoSection(\"editor\");\n\t});\n\n\tdocument.addEventListener(\"click\", (e) => {\n\t\tconst t = event!.target as HTMLElement\n\t\tif (t && t.dataset!.errorMessage) {\n\t\t\tconst val = t.dataset.line as string;\n\t\t\teditor.jumpToLine(+val);\n\t\t}\n\t});\n\n};\n\ninterface LineMappings {\n\tfile: string;\n\tline: number;\n}\nconst buildLineMappings = (listing: string) => {\n\tlet map: LineMappings[] = [];\n\n\tlet file = \"\";\n\tlet line = 0;\n\tlet address = 0;\n\n\tlisting.split(/\\r\\n|\\r|\\n/).forEach((s) => {\n\t\tconst cps = s\n\t\t\t.replace(/\\t/g, \" \")\n\t\t\t.replace(/  /g, \" \")\n\t\t\t.trim();\n\n\t\tconst bits = cps.split(/ /);\n\n\t\tif (bits[0] === \"-------\" && bits[1] === \"FILE\") {\n\t\t\tfile = bits[2];\n\t\t\treturn;\n\t\t}\n\n\t\tif (bits[1] === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tline = parseInt(bits[0], 10);\n\t\taddress = parseInt(bits[1], 16);\n\n\t\tconst f = (line > 0)\n\t\t\t&& (bits[1].length === 4)\n\t\t\t&& (address > 0);\n\n\t\tif (f) {\n\t\t\tmap[address] = {\n\t\t\t\tline,\n\t\t\t\tfile,\n\t\t\t};\n\t\t}\n\t});\n\n\treturn map;\n\t/*\n\t\"------- FILE /file.asm LEVEL 1 PASS 1\n      1  0000 ????\n      2  0000 ????\t\t\t\t      PROCESSOR\t6502\n      3  f000\t\t\t\t\t      ORG\t$F000\n      4  f000\n      5  f000\t\t\t\t   Initialize subroutine\t\t; Cleanup routine from macro.h (by Andrew Davie/DASM)\n      6  f000\n      7  f000\t\t\t\t\t\t\t; Twiddle the bit to watch it change onscreen\n      8  f000\t\t       d8\t\t      CLD\n ------ 4075 bytes free before End of Cartridge\n\"\n*/\n}\n\nconst updateButtons = () => {\n\tconst editorPanel = document.querySelector(\".CodeMirror\") as HTMLElement;\n\n\teditorPanel.style.display = \"\";\n\n\tif (editorFlags.canAssemble) {\n\t\tassembleButton.disabled = false;\n\t\tgoButton.disabled = false;\n\t}\n};\n\nconst onCodeChange = () => {\n\teditorFlags.canAssemble = true;\n\teditorFlags.canRun = false;\n\tupdateButtons();\n};\n\n(window as any).main_init = async () => {\n\teditor.init(onCodeChange);\n\teditor.setValue(`\n\t; Placeholder\n\t  PROCESSOR 6502\n\t  ORG $0600\n\t  RTS\n\t; Placeholder`);\n\n\tsystemWindow = await loadSystemIFrame(\"systems/fantasy-console/fc.html\");\n\n\twireButtons();\n\n\troute.onload();\n\troute.gotoSection(\"editor\");\n\n\tmenuButton.addEventListener(\"click\", async () => {\n\t\troute.gotoSection(\"main\");\n\t});\n\n\n\tloadFileButton.addEventListener(\"click\", async () => {\n\t\troute.gotoSection(\"filelist\");\n\t\tconst assemberWindow = await loadDasmIFrame();\n\n\t\tfileList.pickFile(assemberWindow, \"/examples\", async (file) => {\n\t\t\troute.gotoSection(\"editor\");\n\t\t\teditor.setValue(file.contents);\n\t\t\tdestroydasmIframe();\n\t\t});\n\t});\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACO,IAAM,MAAM,GAAG,CAAC;IACnB,IAAI,CAAC,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACxC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AACxC,CAAC,GAAG;;ACAJ,IAAI,cAAc,GAAG,IAAI,CAAC;AAE1B,IAAM,SAAS,GAAG,GAAG,CAAC;AACtB,IAAM,QAAQ,GAAG,GAAG,CAAC;AAQrB,IAAM,WAAW,GAAG,UAAsC,UAAkB,EAAE,OAAU;IACpF,IAAM,qBAAqB,GAAG,cAAc,CAAC;IAC7C,cAAc,IAAI,CAAC,CAAC;IAEpB,OAAO,IAAI,OAAO,CAAI,UAAC,OAAO,EAAE,MAAM;QAClC,IAAM,aAAa,GAAG,SAAS,aAAa,CAAC,CAAe;YACxD,IAAI,CAAC,CAAC,MAAM,KAAK,MAAM,EAAE;gBACrB,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;gBAEhC,IAAI,IAAI,CAAC,SAAS,KAAK,qBAAqB,EAAE;oBAC1C,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;oBAC5D,OAAO,CAAC,IAAI,CAAC,CAAC;iBACjB;aACJ;SACJ,CAAA;QAED,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;QACzD,OAAO,CAAC,SAAS,GAAG,qBAAqB,CAAC;QAC1C,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,MAAM,CAAC,CAAC;KAC3D,CAAC,CAAC;AACP,CAAC,CAAC;AAGF,IAAM,WAAW,GAAG;IAChB,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;QAC/B,IAAM,aAAa,GAAG,SAAS,aAAa,CAAC,CAAe;YACxD,IAAI,CAAC,CAAC,MAAM,KAAK,MAAM,EAAE;gBACrB,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;gBAEhC,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,EAAE;oBACxB,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;oBAC5D,OAAO,CAAC,IAAI,CAAC,CAAC;iBACjB;aACJ;SACJ,CAAA;QAED,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;KAC5D,CAAC,CAAC;AACP,CAAC,CAAC;AAEF,IAAM,QAAQ,GAAG,UAAC,UAAkB;IAChC,IAAM,OAAO,GAAG;QACZ,MAAM,EAAE,MAAM;KACjB,CAAA;IACD,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,MAAM,CAAC,CAAC;AAC5D,CAAC,CAAC;AAEF,IAAM,gBAAgB,GAAG,UAAC,IAAwB;IAC9C,IAAM,KAAK,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAS,IAAK,OAAA,CAAC,KAAK,GAAG,GAAA,CAAC,CAAC;IAEpE,IAAM,IAAI,GAAoB,KAAK,CAAC,GAAG,CAAC,UAAC,CAAS;QAC9C,IAAM,CAAC,GAAG,EAAE,CAAC,KAAK,CAAI,IAAI,CAAC,GAAG,SAAI,CAAG,CAAC,CAAC;QAEvC,IAAM,KAAK,GAAG,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;QAC/B,IAAM,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;QAEjC,IAAM,IAAI,GAAG,CAAC,KAAK,GAAG,QAAQ,GAAG,EAAE,KAAK,MAAM,GAAG,SAAS,GAAG,EAAE,CAAC,CAAC;QAEjE,IAAM,MAAM,GAAG,IAAI,KAAK,QAAQ,GAAG,IAAI,GAAG,EAAE,CAAC;QAC7C,IAAM,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAC1E,IAAM,CAAC,GAAkB;YACrB,WAAW,aAAA;YACX,IAAI,EAAE,CAAC;YACP,IAAI,MAAA;YACJ,QAAQ,EAAK,IAAI,CAAC,GAAG,SAAI,CAAG;SAE/B,CAAC;QAEF,OAAO,CAAC,CAAC;KACZ,CAAC,CAAC;IAEH,IAAI,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,CAAC,IAAI,KAAK,QAAQ,GAAA,CAAC,CAAC;IACnD,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,CAAC,IAAI,KAAK,SAAS,GAAA,CAAC,CAAC;IAMrD,IAAM,KAAK,GAAG,UAAC,CAAgB,EAAE,CAAgB,IAAK,OAAA,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,GAAA,CAAC;IAE7G,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACjB,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAElB,IAAM,QAAQ,GAAwB;QAClC,SAAS,EAAE,IAAI;QACf,KAAK,iBAAM,IAAI,EAAK,KAAK,CAAC;QAC1B,SAAS,EAAE,IAAI,CAAC,SAAS;KAC5B,CAAC;IAEF,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AACzD,CAAC,CAAC;AAEF,IAAM,eAAe,GAAG,UAAC,OAA0B;IAC/C,EAAE,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;IACnC,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAE5B,IAAM,QAAQ,GAAuB;QACjC,SAAS,EAAE,OAAO,CAAC,SAAS;KAC/B,CAAC;IAEF,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AACzD,CAAC,CAAC;AAEF,IAAM,aAAa,GAAG,UAAC,OAA6B;IAChD,EAAE,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;IACjD,IAAM,QAAQ,GAA0B;QACpC,SAAS,EAAE,OAAO,CAAC,SAAS;KAC/B,CAAC;IACF,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AACzD,CAAC,CAAC;AAEF,IAAM,eAAe,GAAG,UAAC,OAA+B;IACpD,EAAE,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;IACjD,IAAM,QAAQ,GAA4B;QACtC,SAAS,EAAE,OAAO,CAAC,SAAS;KAC/B,CAAC;IACF,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AACzD,CAAC,CAAC;AAEF,IAAM,iBAAiB,GAAG,UAAC,OAA4B;IACnD,IAAM,QAAQ,GAAyB;QACnC,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC;QAC7D,SAAS,EAAE,OAAO,CAAC,SAAS;KAC/B,CAAA;IACD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AACzD,CAAC,CAAC;AAEF,IAAM,mBAAmB,GAAG,UAAC,OAA8B;IACvD,IAAM,QAAQ,GAA2B;QACrC,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;QACvC,SAAS,EAAE,OAAO,CAAC,SAAS;KAC/B,CAAA;IACD,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC;AACzD,CAAC,CAAC;AAQF,IAAM,eAAe,GAAG,UAAU,CAAe;IAC7C,IAAI,CAAC,CAAC,MAAM,KAAK,MAAM,EAAE;QACrB,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAY,CAAC;QAE9C,QAAQ,OAAO,CAAC,MAAM;YAClB,KAAK,eAAe;gBAChB,aAAa,CAAC,OAAO,CAAC,CAAC;gBACvB,MAAM;YACV,KAAK,iBAAiB;gBAClB,eAAe,CAAC,OAAO,CAAC,CAAC;gBACzB,MAAM;YACV,KAAK,cAAc;gBACf,iBAAiB,CAAC,OAAO,CAAC,CAAC;gBAC3B,MAAM;YACV,KAAK,gBAAgB;gBACjB,mBAAmB,CAAC,OAAO,CAAC,CAAC;gBAC7B,MAAM;YACV,KAAK,YAAY;gBACb,eAAe,CAAC,OAAO,CAAC,CAAC;gBACzB,MAAM;YACV,KAAK,aAAa;gBACd,gBAAgB,CAAC,OAAO,CAAC,CAAC;gBAC1B,MAAM;SAGb;KACJ;AACL,CAAC,CAAA;AAED,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;AAE3D,eAAe;IACX,WAAW,aAAA;IACX,WAAW,aAAA;IACX,QAAQ,UAAA;IACR,QAAQ,UAAA;IACR,SAAS,WAAA;CACZ;;ACvLD,IAAM,MAAM,GAAG;IACX,WAAW,CAAC,MAAM,CAAC,CAAC;IACpB,OAAO;AAkBX,CAAC,CAAA;AAED;AACA,MAAM,CAAC,UAAU,GAAG,UAAU,CAAgB;IAC1C,IAAM,OAAO,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC;IAC3C,IAAM,YAAY,GAAG,CAAC,UAAU,CAAC,CAAC;IAElC,IAAI,OAAO,EAAE;QACT,IAAI,YAAY,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACpC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;YACpB,OAAO;SACV;QACD,WAAW,CAAC,OAAO,CAAC,CAAC;KACxB;AACL,CAAC,CAAA;AAED;AACA,IAAM,eAAe,GAAG;IACpB,IAAM,QAAQ,GAAG,QAAQ,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;IACtD,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAA,OAAO;QAChC,OAAO,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;KAClC,CAAC,CAAA;AACN,CAAC,CAAC;AAEF,IAAM,WAAW,IAAI,UAAC,SAAiB;IACnC,eAAe,EAAE,CAAC;IAClB,IAAM,QAAQ,GAAG,8BAA4B,SAAS,OAAI,CAAC;IAC3D,IAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAiB,CAAC;IAC5D,EAAE,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC;AAC1B,CAAC,CAAC,CAAC;AAEH,IAAM,WAAW,GAAG,UAAC,OAAc;IAC/B,WAAW,CAAC,OAAO,CAAC,CAAC;IACrB,OAAO;AAWX,CAAC,CAAC;AAEF,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAC,KAAK;;IAC1C,IAAM,CAAC,GAAG,KAAK,CAAC,MAAqB,CAAC;IACtC,UAAI,CAAC,aAAD,CAAC,uBAAD,CAAC,CAAE,OAAO,0CAAE,IAAI,EAAE;;QAElB,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC/B;AACL,CAAC,CAAC,CAAC;AAEH,YAAe;IACX,MAAM,QAAA;IACN,eAAe,iBAAA;IACf,WAAW,aAAA;CACd;;AC1FD;AACA;AACA;AACA;AACA,IAAI,EAAqB,CAAC;AAI1B,IAAI,cAAc,GAAG,CAAC,CAAC,CAAC;AACxB,IAAM,iBAAiB,GAAG,sBAAsB,CAAC;AAEjD,IAAM,IAAI,GAAG,UAAC,QAAoB;IAC9B,EAAE,GAAG,UAAU,CAAC,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,EAAE;QAC5D,WAAW,EAAE,IAAI;QACjB,KAAK,EAAE,MAAM;QACb,YAAY,EAAE,IAAI;QAClB,OAAO,EAAE,CAAC,wBAAwB,EAAE,aAAa,CAAC;QAClD,WAAW,EAAE,IAAI;QACjB,eAAe,EAAE,IAAI;KACxB,CAAC,CAAC;IAEH,EAAE,CAAC,EAAE,CAAC,QAAQ,EAAE;QACZ,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;YAChC,QAAQ,EAAE,CAAC;SACd;KACJ,CAAC,CAAC;IAEH,EAAE,CAAC,EAAE,CAAC,aAAa,EAAE,UAAU,EAAE,EAAE,CAAC;QAChC,IAAI,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QAC1B,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QACpE,EAAE,CAAC,eAAe,CAAC,CAAC,EAAE,aAAa,EAAE,CAAC,IAAI,GAAG,IAAI,GAAG,UAAU,EAAE,CAAC,CAAC;KACrE,CAAC,CAAC;IAEH,SAAS,UAAU;QACf,IAAI,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC3C,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;QAC5B,MAAM,CAAC,SAAS,GAAG,GAAG,CAAC;QACvB,OAAO,MAAM,CAAC;KACjB;AACL,CAAC,CAAC;AAEF,IAAM,aAAa,GAAG,UAAC,IAAY;IAC/B,eAAe,CAAC,cAAc,CAAC,CAAC;IAChC,cAAc,GAAG,IAAI,CAAC;IACtB,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;IAC9C,MAAM,CAAC,SAAS,GAAG,GAAG,CAAC;IACvB,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,OAAO,CAAC;IAC7B,MAAM,CAAC,KAAK,CAAC,UAAU,GAAG,OAAO,CAAC;IAClC,EAAE,CAAC,eAAe,CAAC,IAAI,GAAG,CAAC,EAAE,cAAc,EAAE,MAAM,CAAC,CAAC;IACrD,EAAE,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;AACrD,CAAC,CAAC;AAEF,IAAM,eAAe,GAAG,UAAC,IAAY;IACjC,EAAE,CAAC,eAAe,CAAC,IAAI,GAAG,CAAC,EAAE,cAAc,EAAE,IAAI,CAAC,CAAC;AACvD,CAAC,CAAC;AAEF,IAAM,QAAQ,GAAG,UAAC,KAAa;IAC3B,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;AACvB,CAAC,CAAA;AAED,IAAM,QAAQ,GAAG;IACb,OAAO,EAAE,CAAC,QAAQ,EAAE,CAAC;AACzB,CAAC,CAAA;AAED,IAAM,cAAc,GAAG;IACnB,EAAE,CAAC,QAAQ,CAAC,UAAC,CAAC;QACV,EAAE,CAAC,eAAe,CAAC,CAAC,EAAE,YAAY,EAAE,iBAAiB,CAAC,CAAC;KAC1D,CAAC,CAAC;AACP,CAAC,CAAA;AAED,IAAM,SAAS,GAAG,UAAC,MAAgB;IAC/B,cAAc,EAAE,CAAC;IACjB,MAAM,CAAC,OAAO,CAAC,UAAA,CAAC;QACZ,EAAE,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,EAAE,YAAY,EAAE,iBAAiB,CAAC,CAAC;KAC3D,CAAC,CAAC;AACP,CAAC,CAAA;AAED,IAAM,UAAU,GAAG,UAAC,CAAS;IACzB,IAAI,CAAC,GAAG,EAAE,CAAC,UAAU,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,GAAG,CAAC;IACvD,IAAI,YAAY,GAAG,EAAE,CAAC,kBAAkB,EAAE,CAAC,YAAY,GAAG,CAAC,CAAC;IAC5D,EAAE,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,GAAG,YAAY,GAAG,CAAC,CAAC,CAAC;IACxC,EAAE,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IACvB,EAAE,CAAC,KAAK,EAAE,CAAC;AACf,CAAC,CAAA;AAEM,IAAM,MAAM,GAAG;IAClB,IAAI,MAAA;IACJ,QAAQ,UAAA;IACR,QAAQ,UAAA;IACR,aAAa,eAAA;IACb,cAAc,gBAAA;IACd,SAAS,WAAA;IACT,UAAU,YAAA;CACb;;ACtFM,IAAM,QAAQ,GAAG,CAAC;IACrB,IAAM,QAAQ,GAAG,UACb,EAAU,EACV,GAAW,EACX,QAAqC;;;;;oBAC/B,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAgB,CAAC;oBACrE,SAAS,CAAC,SAAS,GAAG,EAAE,CAAC;oBAEX,qBAAM,QAAQ,CAAC,WAAW,CACnC,EAAE,EAAE;4BACD,MAAM,EAAE,aAAa;4BACrB,GAAG,EAAE,GAAG;4BACR,SAAS,EAAE,CAAC;yBACf,CAAC,EAAA;;oBALA,KAAK,GAAG,SAKR;oBAEN,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE,EAAE,OAAO,CAAC,UAAC,CAAC;wBAC1B,IAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;wBACxC,IAAM,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;wBAEtC,IAAM,CAAC,GAAG,QAAQ,CAAC,cAAc,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;wBAEjD,CAAC,CAAC,IAAI,GAAG,MAAI,CAAC,CAAC,QAAU,CAAC;wBAC1B,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;wBACjB,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;wBAElB,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;wBAClC,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;wBAE1B,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAO,KAAK;;;;;;wCACpC,KAAK,CAAC,cAAc,EAAE,CAAC;wCACjB,MAAM,GAAG,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,MAAyB,CAAC;wCAE1C,QAAQ,GAAG,OAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,IAAI,0CAAE,KAAK,CAAC,GAAG,EAAE,CAAC,MAAK,IAAI,CAAC;6CAEjD,KAAK,CAAC,KAAK,EAAX,wBAAW;wCACL,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,CAAC,QAAQ,KAAK,QAAQ,GAAA,CAAC,CAAC,CAAC,CAAC,CAAC;8CAE5D,CAAC,CAAC,IAAI,KAAK,QAAQ,CAAC,SAAS,CAAA,EAA7B,wBAA6B;wCAEF,qBAAM,QAAQ,CAAC,WAAW,CAA4C,EAAE,EAAE;gDACjG,MAAM,EAAE,cAAc;gDACtB,SAAS,EAAE,CAAC;gDACZ,QAAQ,EAAE,QAAQ;6CACrB,CAAC,EAAA;;wCAJI,kBAAkB,GAAG,SAIzB;wCAEF,QAAQ,CAAC;4CACL,QAAQ,EAAE,QAAQ;4CAClB,QAAQ,EAAE,CAAA,kBAAkB,aAAlB,kBAAkB,uBAAlB,kBAAkB,CAAE,QAAQ,KAAI,EAAE;yCAC/C,CAAC,CAAC;;;wCAEH,QAAQ,CAAC,EAAE,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;;;;;6BAG5C,CAAC,CAAC;qBACN,CAAC,CAAC;;;;SACN,CAAC;IAEF,OAAO;QACH,QAAQ,UAAA;KACX,CAAA;AACL,CAAC,GAAG;;AC5DJ,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,eAAe,CAAsB,CAAC;AAC9E,IAAM,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,oBAAoB,CAAsB,CAAC;AACzF,IAAM,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,sBAAsB,CAAsB,CAAC;AAC3F,IAAM,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,sBAAsB,CAAsB,CAAC;AAC3F,IAAM,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,kBAAkB,CAAmB,CAAC;AACpF,IAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,eAAe,CAAsB,CAAC;AAEhF,IAAI,YAAoB,CAAC;AAEzB,IAAM,cAAc,GAAG,aAAa,CAAC;AAErC,IAAM,WAAW,GAAG;IACnB,WAAW,EAAE,IAAI;IACjB,MAAM,EAAE,KAAK;CACb,CAAC;AAmBF,IAAM,iBAAiB,GAAG;;;QACnB,SAAS,GAAG,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC;QAC1D,IAAI,SAAS,EAAE;YACd,SAAS,CAAC,UAAW,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;SAC7C;;;KACD,CAAA;AAED,IAAM,cAAc,GAAG;;;;oBACtB,qBAAM,iBAAiB,EAAE,EAAA;;gBAAzB,SAAyB,CAAC;gBAEpB,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;gBACpD,UAAU,CAAC,EAAE,GAAG,cAAc,CAAC;gBAC/B,UAAU,CAAC,GAAG,GAAG,WAAW,CAAC;gBAC7B,UAAU,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;gBAElC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;gBAEtC,qBAAM,QAAQ,CAAC,WAAW,EAAE,EAAA;;gBAA5B,SAA4B,CAAC;gBAE7B,sBAAO,UAAU,CAAC,aAAc,EAAC;;;KACjC,CAAC;AAEF,IAAM,gBAAgB,GAAG,UAAO,GAAW;;;QACpC,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAmB,CAAC;QACtE,IAAI,SAAS,CAAC,UAAU,EAAE;YACzB,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;SAC5C;QAEK,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACtD,YAAY,CAAC,EAAE,GAAG,eAAe,CAAC;QAClC,YAAY,CAAC,GAAG,GAAG,GAAG,CAAC;QAEvB,SAAS,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;;QAIpC,sBAAO,YAAY,CAAC,aAAc,EAAC;;KACnC,CAAC;AAGF,IAAM,QAAQ,GAAG,UAChB,eAAoB,EACpB,QAAgB,EAChB,GAAW;;;;;gBACX,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;gBAED,qBAAM,QAAQ,CAAC,WAAW,CAA8C,eAAe,EAAE;wBACjH,SAAS,EAAE,CAAC;wBACZ,MAAM,EAAE,eAAe;wBACvB,QAAQ,EAAK,QAAQ,SAAM;wBAC3B,QAAQ,EAAE,GAAG;qBACb,CAAC,EAAA;;gBALI,gBAAgB,GAAG,SAKvB;gBAEF,qBAAM,QAAQ,CAAC,WAAW,CAAwC,eAAe,EAAE;wBAClF,SAAS,EAAE,CAAC;wBACZ,MAAM,EAAE,YAAY;wBACpB,QAAQ,EAAK,QAAQ,SAAM;qBAC3B,CAAC,EAAA;;gBAJF,SAIE,CAAC;gBAEoB,qBAAM,QAAQ,CAAC,WAAW,CAA4C,eAAe,EAAE;wBAC7G,SAAS,EAAE,CAAC;wBACZ,MAAM,EAAE,cAAc;wBACtB,QAAQ,EAAE,KAAG,QAAU;qBACvB,CAAC,EAAA;;gBAJI,cAAc,GAAG,SAIrB;gBAEI,UAAU,GAAG,cAAc,CAAC,MAAM,CAAC,GAAG,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,IAAI,GAAA,CAAC,CAAC;gBAE1D,IAAI,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE;oBACtB,GAAG,GAAmB;wBAC3B,MAAM,EAAE,UAAU;wBAClB,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,MAAM,CAAC;qBAC3C,CAAC;oBAEF,OAAO,CAAC,GAAG,CAAC,aAAW,GAAG,CAAC,MAAQ,CAAC,CAAC;oBAC/B,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC;iBAC5D;qBAAM;oBACN,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;oBAE7B,cAAe,CAAC,SAAS,GAAG,cAAc,CAAC,MAAM,CAAC,GAAG,CAAC,UAAA,CAAC;wBACtD,OAAO,0DAC6B,CAAC,CAAC,KAAK,yCAChB,CAAC,CAAC,IAAI,yCACN,CAAC,CAAC,IAAI,0CACL,CAAC,CAAC,IAAI,UAAK,CAAC,CAAC,KAAK,0BAC7B,CAAC;qBAClB,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAEhB,WAAW,CAAC,MAAM,GAAG,CAAC,cAAc,CAAC,MAAM,CAAC,MAAM,CAAC;iBACnD;gBAED,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;gBAE5B,sBAAO,cAAc,EAAC;;;KACtB,CAAC;AAEF,IAAM,WAAW,GAAG;IACnB,IAAI,YAAY,CAAC;IAEjB,IAAM,WAAW,GAAG,UAAO,QAAgB,EAAE,GAAW;;;;wBAC/B,qBAAM,cAAc,EAAE,EAAA;;oBAAxC,eAAe,GAAG,SAAsB;oBACvB,qBAAM,QAAQ,CAAC,eAAe,EAAE,QAAQ,EAAE,GAAG,CAAC,EAAA;;oBAA/D,cAAc,GAAG,SAA8C;oBACrE,iBAAiB,EAAE,CAAC;;oBAGpB,YAAY,GAAG,iBAAiB,CAAC,CAAA,cAAc,aAAd,cAAc,uBAAd,cAAc,CAAE,OAAO,KAAI,IAAI,CAAC,CAAC;oBAElE,aAAa,EAAE,CAAC;;;;SAChB,CAAC;IAEF,QAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE;;;wBACnC,qBAAM,WAAW,CAAC,OAAO,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC,EAAA;;oBAA7C,SAA6C,CAAC;;;;SAC9C,CAAC,CAAC;IAEH,cAAe,CAAC,gBAAgB,CAAC,OAAO,EAAE;QACzC,WAAW,CAAC,OAAO,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;KACxC,CAAC,CAAC;IAEH,cAAe,CAAC,gBAAgB,CAAC,OAAO,EAAE;QACzC,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;KAC5B,CAAC,CAAC;IAEH,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAC,CAAC;QACpC,IAAM,CAAC,GAAG,KAAM,CAAC,MAAqB,CAAA;QACtC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAQ,CAAC,YAAY,EAAE;YACjC,IAAM,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC,IAAc,CAAC;YACrC,MAAM,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC;SACxB;KACD,CAAC,CAAC;AAEJ,CAAC,CAAC;AAMF,IAAM,iBAAiB,GAAG,UAAC,OAAe;IACzC,IAAI,GAAG,GAAmB,EAAE,CAAC;IAE7B,IAAI,IAAI,GAAG,EAAE,CAAC;IACd,IAAI,IAAI,GAAG,CAAC,CAAC;IACb,IAAI,OAAO,GAAG,CAAC,CAAC;IAEhB,OAAO,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,UAAC,CAAC;QACrC,IAAM,GAAG,GAAG,CAAC;aACX,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;aACnB,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;aACnB,IAAI,EAAE,CAAC;QAET,IAAM,IAAI,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAE5B,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,MAAM,EAAE;YAChD,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;YACf,OAAO;SACP;QAED,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;YAC1B,OAAO;SACP;QAED,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QAC7B,OAAO,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QAEhC,IAAM,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC;gBACd,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;gBACrB,OAAO,GAAG,CAAC,CAAC,CAAC;QAElB,IAAI,CAAC,EAAE;YACN,GAAG,CAAC,OAAO,CAAC,GAAG;gBACd,IAAI,MAAA;gBACJ,IAAI,MAAA;aACJ,CAAC;SACF;KACD,CAAC,CAAC;IAEH,OAAO,GAAG,CAAC;;;;;;;;;;;;;;AAcZ,CAAC,CAAA;AAED,IAAM,aAAa,GAAG;IACrB,IAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAgB,CAAC;IAEzE,WAAW,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC;IAE/B,IAAI,WAAW,CAAC,WAAW,EAAE;QAC5B,cAAc,CAAC,QAAQ,GAAG,KAAK,CAAC;QAChC,QAAQ,CAAC,QAAQ,GAAG,KAAK,CAAC;KAC1B;AACF,CAAC,CAAC;AAEF,IAAM,YAAY,GAAG;IACpB,WAAW,CAAC,WAAW,GAAG,IAAI,CAAC;IAC/B,WAAW,CAAC,MAAM,GAAG,KAAK,CAAC;IAC3B,aAAa,EAAE,CAAC;AACjB,CAAC,CAAC;AAED,MAAc,CAAC,SAAS,GAAG;;;;gBAC3B,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;gBAC1B,MAAM,CAAC,QAAQ,CAAC,gFAKF,CAAC,CAAC;gBAED,qBAAM,gBAAgB,CAAC,iCAAiC,CAAC,EAAA;;gBAAxE,YAAY,GAAG,SAAyD,CAAC;gBAEzE,WAAW,EAAE,CAAC;gBAEd,KAAK,CAAC,MAAM,EAAE,CAAC;gBACf,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;gBAE5B,UAAU,CAAC,gBAAgB,CAAC,OAAO,EAAE;;wBACpC,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;;;qBAC1B,CAAC,CAAC;gBAGH,cAAc,CAAC,gBAAgB,CAAC,OAAO,EAAE;;;;;gCACxC,KAAK,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;gCACP,qBAAM,cAAc,EAAE,EAAA;;gCAAvC,cAAc,GAAG,SAAsB;gCAE7C,QAAQ,CAAC,QAAQ,CAAC,cAAc,EAAE,WAAW,EAAE,UAAO,IAAI;;wCACzD,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;wCAC5B,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;wCAC/B,iBAAiB,EAAE,CAAC;;;qCACpB,CAAC,CAAC;;;;qBACH,CAAC,CAAC;;;;KACH"}